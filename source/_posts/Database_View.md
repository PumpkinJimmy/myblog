---
abbrlink: '0'
date: 2021-09-18 10:35:36
---
# 数据库：视图
## 视图的作用
- 简化查询：将复杂的嵌套查询简化成多个步骤
- 隐藏完整的逻辑关系模式
- 面向不同的应用提供不同的数据接口
- 保护数据，便于管理权限

## 视图的实质
视图**并不是真正的表**，尽管它在`select/insert`的使用中可以平行替换表的位置：
- **视图没有物理实体**：视图不对应物理上的表和表数据，不存在元组
- **视图没有缓存数据信息**：视图在执行时会替换成等效的子查询
- **对视图的更新会应用于原表**：视图没有实体，对视图应用更新语句实际上会更新原来的表
- 视图可以嵌套

## 定义视图
```sql
create view v as (select ...)
```

## 使用视图修改
- 由于视图没有实体，**对视图更新会作用在原来的表上**
- 通常只允许使用简单视图进行修改：
  - `from`子句只能包含一个关系
  - `select`子句只包含原始的属性名，不能包含表达式、聚集属性或者`distinct`限定
  - 所有不出现在`select`中的属性都必须是可以为空的
  - 不包含`group by`以及`having`

### 检查视图条件
只要满足简单视图的条件，任何对视图的修改都可以作用于原表数据，但这通常都不是视图想实现的特性。

使用`with check option`限定可以要求在插入时检查`where`子句

## 实例化视图
实例化视图(Materializing a view)是存在物理实体的视图。

实例化视图的主要用途是*提高查询速度*，因为并不是简单的子查询替换，因而效率会更高。

实例化视图存在*数据不一致*问题。

