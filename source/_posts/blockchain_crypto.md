---
date: 2021-09-16 02:02:54
---
# 区块链密码学基础
区块链的密码学基础是：
- 公钥加密
- 单向散列

## 哈希的密码学安全
称满足如下条件的哈希函数是**密码学安全**的：
1. 抗碰撞(Collision Resistence)
2. 隐秘性(Hiding)
3. 谜题友好(Puzzling Friendly)

### 抗碰撞

碰撞阻力可以理解为抗对撞能力。

容易发现：
$$
    x \ne y \rightarrow H(x) \ne H(y)
$$
实际上是不可能达到的。

因为哈希函数的输入可以是任意长，但输出确是定长的。容易发现一定存在两组不同的输入具有相同的哈希值。

因此抗碰撞是指
- 对于给定$x$，求解$y$使得$y\ne x$且$H(x)=H(y)$**在计算上不可行**

也就是说**设计足够好的哈希函数不容易碰撞**。

以SHA-256为例，由于映射的过程（看起来）近于随机，只能随机碰撞，要随机碰撞的话平均需要$2^{128}$次计算。

具有碰撞阻力的哈希函数可以用于生成*数据摘要*，如MD5


### 隐秘性

隐秘性也称单向性。

隐秘性要求：
- 对于给定$H(x)$，求解$y$使得$H(x)=H(y)$**在计算上不可行**

支持隐秘性和抗碰撞能力的哈希函数可以用于实现*承诺协议*。

### 谜题友好

谜题友好是指：
- 对于给定$H(x || k)$和$x$，快速求解$k$在计算上不可行。

谜题友好保证了**任何求解者都不能快速求出满足条件的哈希函数值的原像，只能暴力搜索。**

哈希函数的谜题友好性可以用于*工作量证明(PoW)*，也是挖矿的实质。

## “公钥即身份”——数字签名

### 数字签名鉴别
使用数字签名三部曲
1. 生成密钥：生成密钥对$(pk, sk)$，公开公钥并保管私钥
2. 签名：生成一个随机数$nounce$，使用私钥加密得到$com = E_{sk}(nounce)$
3. 鉴别：发送$com$，通过鉴别$D_{pk}(com)$和$msg$是否相等来鉴别身份

### 匿名性
某种意义上，**公钥即身份**，通过公布公钥，我们可以在网络上鉴别自己的身份。