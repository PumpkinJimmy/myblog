---
date: 2021-11-30 14:28:55.944434+08:00
title: 图像分割

---
# 图像分割
## 合法的图像分割
- 区域内连续
- 不重叠
- 不遗漏
- 各个区域存在共性，区域之间存在区分

## 边缘提取
- 二阶微分：拉普拉斯算子
- 一阶微分：Sobel/Robert
- 高斯-拉普拉斯算子（LoG）
- 高斯差分滤波（DoG）
  - 对两个LoG滤波的差分逼近零交叉的计算
- **Canny**

### Canny
- 一阶微分
- 非极大抑制
- 双阈值法
- 弱边缘补齐强边缘
  - 以强边缘为起始
  - 在弱边缘上利用8-连通性延展
  - 最终补齐边缘

## 边缘连接
只有强度和走势相吻合才可以连接。
 
- 区域逼近边缘（多边形近似）
- Hough直线检测

### Hough直线检测
- 考虑平面上直线的极坐标方程。若令$\rho, \theta$是参数，则任何一直线对应参数空间中的一个点
- 利用上述模型，**经过定点的所有直线的参数点落在某正弦曲线上**
- 对于多个点，**计算每个点对应的参数空间正弦曲线，取相交最多的参数点，就是最合适的曲线**。这是一种投票思想
- 实际实现中，由于离散性，不必解三角方程，而是直接遍历求值投票
- 类似的思想可以用于拟合其他参数曲线

## 阈值化
- 基于直方图：可能要先降噪
- 全局阈值化
- 局部阈值化
- 自适应阈值化（Adaptive）
- 自适应全局阈值化（OTSU）

### 全局阈值化

试探法：一个简单的迭代算法找全局二值化阈值

1. 随便选一个初始值
2. 计算阈值两边的像素平均灰度$m_1,m_2$
3. 取新的阈值为$(m_1+m_2)/2$
4. 返回2，迭代直到收敛
  
### 光照干扰
光照成像模型：
$$

$$

不均匀光照条件下的矫正法：
- 实验法：使用一个平坦灰度物体在环境下直接拍照获得不均匀光照
- 顶帽变换获得光照模式
- 局部阈值化：在足够小的邻域中不均匀光照的影响忽略。此时再在局部应用阈值化即可。

### OTSU法
- 评判阈值的质量
  
  一个统一的指标$\eta$:
  $$
    \eta = \frac{\sigma^2_B}{\sigma^2_G}
  $$

  其中$\sigma^2_G$是全局方差。

  $\sigma^2_B$是*类间方差*：
  $$
    P_1(m_1 - m_G)^2 + P_2(m_2 - m_G)^2
  $$

  类间方差其实是度量分割后的两类分得有多开。

- 基于最大化类间方差的阈值选择
  
  令$\eta(k) = \sigma^2_B(k) / \sigma_G$

  则$k^* = \mathrm{argmax}_k (\eta(k))$

- 总结OTSU法：
  1. 计算直方图
  2. 计算阈值k
  3. 利用k做二值分割

### 局部阈值法：利用边缘改善阈值化
1. 计算一阶/二阶微分图
2. 根据微分选定阈值k
3. 使用k对微分图做二值化得到$g_T(x,y)$
4. 计算$h(x,y) = f(x,y)g_T(x,y)$，计算$h(x,y)$直方图
5. 对$h(x,y)$用OTSU法

### 自适应阈值法
每个邻域选定自己的阈值。

阈值的选定与局部均值和局部方差有关。

例如：$T_{xy} = a\sigma_{xy} + b m_{xy}$

## 基于区域的分割
1. 取种子
2. 定义生长条件
3. 定义终止条件

算法：
1. 找连通分量
2. 把每个连通分量腐蚀到只剩下一个像素作为种子
3. 取种子做生长，完成分割