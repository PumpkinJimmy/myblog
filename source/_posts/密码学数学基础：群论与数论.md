---
title: 密码学数学基础：群论与数论
date: 2023-06-08T18:10:36+08:00
tags:
- 数学
- 密码学
- 数论
- 群论
categories:
- 密码学
---


## 同余概念


设$n \in \mathbb{N}$，我们称在模$n$下$a$同余$b$，当且仅当$n | (a-b)$，记作
$$
    a \equiv b\ (\mathrm{mod}\ n)
$$

其中$a,b \in \mathbb{Z}$

注意：
- 同余讨论的对象是整数，*包括负数和0*
- 但同余中的模*必须是大于0的自然数*，不允许负数和0
  - 尽管编程语言中总是会实现取负数模的情况，但这不是标准的
  - 因此不同语言中的负数取模算法并不统一

## 同余性质

1. 同余是等价关系：也即满足自反、对称、传递
2. 同余的加减乘法则
   
   若$a \equiv b, c \equiv d\ (mod\ n)$, 则

   $$
    a \pm c \equiv b \pm d \ (mod\ n)\\
    ac \equiv bd\ (mod\ n)
   $$

   推论，$\forall k, d \in \mathbb{Z}, ka \pm d \equiv kb \pm d \ (mod\ n)$

   注意：*这里不含除法*

3. 同余的除法法则
   
   若$\mathrm{gcd}(c,n) = g$，则

   $$
    ac \equiv bc \ (mod\ n) \Leftrightarrow a \equiv b \ (mod\ n/g)
   $$

   推论：若$c,n$互质，则：
    $$
    ac \equiv bc \ (mod\ n) \Leftrightarrow a \equiv b \ (mod\ n)
   $$


   直观来说，想要在同余两端应用除法，必须满足除数是同余两端的公约数的同时，修改模数（而加减乘都不修改模）。推论指出若除数与模互质则加减乘除对同余两端是通行的。

   模的乘法扩增有助于将不同模的同余关系统一到同一个模下（通过替换为最小公倍数）

4. 同余的乘方法则
   
   令$a,b \in \mathbb{Z}, m,n \in \mathbb{N}$，且$a \equiv b\ (\mathrm{mod}\ n)$，则有：

   $$
        a^m \equiv b^m \ (\mathrm{mod}\ n)
   $$

5. 模的扩张与收缩
   
   令$a,b \in \mathbb{Z}, m,n \in \mathbb{N}$，且$a \equiv b\ (\mathrm{mod}\ n)$，则有：

   $$
    am \equiv bm\ (\mathrm{mod}\ mn)
   $$

   若$m|n$，则有
   $$
    a \equiv b \ (\mathrm{mod}\ m)
   $$

   直观来说，这意味着模可以任意替换为其因数而不改变同余关系

## 剩余系

动机：引入模算术

- 最小剩余
  - 定义：给定模$n$，整数$a$，定义$a$的最小剩余为满足$a = nq + r$的*最小非负数*$r$（其中$q$是整数）。
  - 直观来说，$a$的最小剩余$r$就是通常意义上的$a$关于模$n$的“余数”
- 剩余类
  - 将最小剩余相同的整数划分到同一个子集中，这样的子集称为**剩余类**；整数集$\mathbb{Z}$被划分为$n$个不相交的剩余类，也即可以证明对于给定模$n$，$\mathbb{Z}$中的任意一个元素属于且只属于一个剩余类
  - 整数$a$所属的剩余类记作$\bar{a}$。注意不同的记号可能表示同一个剩余类，如对于任意满足$a \equiv b\ \pmod n$的整数$a,b$，有$\bar a = \bar b$
  - 模$n$恰有$n$个不同的剩余类
- 完全剩余系
  - 定义
    
    设$n \in \mathbb{N}$，从模$n$的$n$个不同的剩余类中各取一个整数组成含$n$个数的集合$\mathcal{T}$称为**完全剩余系**（简称完系）

  - 等价的表述：任取一个整数$a$，集合$\mathcal{T}$中唯一存在一个$r_i \in \mathcal{T}$满足$a \equiv r_i \pmod n$
  - 对于模$n$，任意$n$个连续整数组成的集合都是$n$的一个完全剩余系
    - 推论：**集合$\{0, 1, 2, \dots, n-1\}$是$n$的一个完全剩余系**

## 模算术

- 模算术以同模下的剩余类作为运算对象，包含加法和乘法的算术
- 定义剩余类之和$\bar a + \bar b$是满足如下条件的剩余类：
  
  $$
    \bar a + \bar b = \{c\ |\ c = x + y, x \in \bar x, y \in \bar b\}
  $$

 定义剩余类之积$\bar a \bar b$为满足如下条件的剩余类：
  
  $$
    \bar a\bar b = \{c\ |\ c = xy, x \in \bar x, y \in \bar b\}
  $$

- 剩余类的加法、乘法运算的封闭性：
  
  $$
    \bar a \pm \bar b = \overline{a \pm b}
  $$

  $$
    \bar a \bar b = \overline{ab}
  $$

- 模加法和模乘法都是合法的群，因此
  - 存在乘法单位元$\bar 1$，加法单位元$\bar 0$
  - 存在加法逆元$\overline{-a}$
- 模运算满足加法交换律、结合律、乘法交换律、结合律，还满足乘法分配律

## 整数模$n$环

我们将模算术的性质进一步提炼为一种抽象代数结构。

对于$n \in \mathbb{N}$，集合

$$
    \mathbb{Z}/n\mathbb{Z} = \{\bar 0, \bar 1, \bar 2, \dots, \overline{n-1}\}
$$

是一个*整数模$n$环*。其中“环”是一种代数结构，它包含集合$G$以及在其上定义的两种二元运算（通常称作“加法”和“乘法”）。

### 环的定义

环$(G, +, \cdot)$满足以下性质：
1. $(G, +)$为*交换群*，也即：
   - 满足结合律：$a+b+c = a+(b+c)$
   - 存在单位元：$a + 0 = a$
   - 存在逆元：$a + (-a) = 0$
   - 满足交换律：$a + b = b + a$
   - 注意，满足前三条的就是群，加上最后一条就是交换群
2. $(G, \cdot)$为*幺半群*，也即：
   - 满足结合律：$a \cdot b \cdot c = a\cdot(b\cdot c)$
   - 存在单位元：$a \cdot 1 = a$
   - 注意：由于不要求存在逆元，所以这还不是一个群，而只是幺半群（结合的、存在单位元的代数结构）
3. 乘法对加法满足*分配律*，也即$\forall a,b,c \in G$满足：
   
   $$
    a\cdot(b + c) = a\cdot b + a\cdot c\\
    (a+b)\cdot c = a\cdot c + b \cdot c
   $$

### 含单位元的交换环

而整数模$n$环是一个*含单位元的交换环*，也即在环的基础上额外满足*乘法交换律*。

> 强调“含单位元”是因为旧的抽象代数课本不要求环上乘法存在单位元，也即按照老课本的定义环上的乘法只需要是半群而非幺半群，又整数模$n$环存在乘法单位元，因此需要专门强调“含单位元”。
> 
> 本文中环的定义用的是较新的版本

实际上整数环$\mathbb{Z}$，整数模$n$环$\mathbb{Z}/n\mathbb{Z}$都是带单位元的交换环。

### 整数环与整数模$n$环

一个非常重要的在整数环上成立而在整数模$n$环上不一定成立的性质是*乘法消去律*，也即对于$\mathbb{Z}$有如下结论：

$$
    ac = bc(c\ne 0)\to a = b
$$

但对于$\mathbb{Z}/n\mathbb{Z}$这样的性质不成立：

$$
    ac \equiv bc(c\ne 0)\not \to a\equiv b
$$

更进一步，根据同余的除法性质，我们知道消去律成立的充要条件是$\mathrm{gcd}(c, n) = 1$。此时我们会有如下推论成立：

$$
    \mathrm{gcd(a,n)} \Leftrightarrow \exist x  \in \mathbb{Z}, ax \equiv 1 \pmod n
$$

这一结论将引出“乘法逆元”

## 乘法逆元与乘法群

- 乘法逆元的定义：设$a \in \mathbb{Z}, n \in \mathbb{N}$，满足$ax \equiv 1 \pmod n$的最小正整数$x$称为$a$关于$n$的*乘法逆元*，记作$x = a^{-1}$

- 乘法群
  - 若希望对于任意的$a\in \mathbb{Z}$都有逆元，则必须$n$是质数（从而与任何整数互质）。此时剩余类的乘法成立的是阿贝尔乘法群。

  - 设整数模$n$群的乘法记作$(\mathbb{Z}/n\mathbb{Z})*$，则**运算$(\mathbb{Z}/n\mathbb{Z})*$对应阿贝尔乘法群的充要条件是$n$为质数**

  - 注意整数环$\mathbb{Z}$不成立乘法群，因为除了$\pm 1$之外的整数都没有逆元

- 零因子
  - 对于环$(G, +, \cdot)$，若存在$s, t \in G$满足$s \ne 0, t \ne 0, st = 0$，则称环$G$是含零因子的。
  - 整数环$\mathbb{Z}$是没有零因子的
  - 若$n$是合数，$\mathbb{Z}/n\mathbb{Z}$*总是存在零因子*
  - 整数模$n$环关于零因子的结论：**环$\mathbb{Z}/n\mathbb{Z}$无零因子的充要条件是$n$为质数**
  - 如此我们引出这样一种代数结构：它是一个环，它无零因子，且它的乘法是存在单位元的且可交换的，它叫做“域”

## 域$\mathbb{Z} / p \mathbb{Z}$

### 域的定义
- 域$(K, +, \times)$是满足如下条件的代数结构：
  - $(K, +)$是*交换群*，且将其单位元记作$0_K$
  - $(K-\{0_K\}, \times)$是*交换群*
  - 成立分配律
- 直观来说，域最显著的特点是它是*对四则运算封闭*的代数结构
  - 最典型的域是有理数域$Q$

### $\mathbb{Z} / p \mathbb{Z}$
- **整数模$n$环$\mathbb{Z} / p \mathbb{Z}$为一个域的充要条件是$n$为质数**，记作域$\mathbb{Z} / p \mathbb{Z}$，也记作$\mathbb{F}_p$

### 域的乘法群

- 我们使用符号$(\mathbb{Z} / p \mathbb{Z})*$表示域$\mathbb{F}_p$中包含的乘法群$(K - \{0_K\}, \times)$
- 我们对上述符号稍作推广将其用于模$n$环上，定义乘法群$(\mathbb{Z} / n \mathbb{Z})*$为：

  $$
    (\mathbb{Z} / n \mathbb{Z})* := \{ \bar a \in \mathbb{Z}/n\mathbb{Z} : 0 \le a < n \land  \mathrm{gcd}(a,n) = 1\}
  $$

  直觉来说就是取出模$n$环的一个子集使其成立乘法群

### 讨论域的意义
无论是声明模$p$环是域，还是从模$n$环提取乘法群，其核心意义都在于**在$(\mathbb{Z} / n \mathbb{Z})*$上除法是良定义的，定义为乘以乘法逆元**

## 数论入门
（待完善）

### 威尔逊定理

（待完善）


### 费马小定理

设$a \in \mathbb{Z}, p \in \mathbb{N}$，其中$p$是质数，则：

$$
  a^{p-1} \equiv 1 \pmod p
$$

### 欧拉函数
- 定义：$\phi(n)$表示比整数$n$小的正整数中，与$n$互质的数的个数
  - 显然，素数$p$满足$\phi(p) = p - 1$
- 性质：
  - 积性函数：$\phi(m)\phi(n) = \phi(mn)$

### 既约剩余系

（待完善）

### 欧拉定理

对$a \in \mathbb{Z}, n \in \mathbb{N}$，若$\mathrm{gcd}(a, n) = 1$，则：
$$
  a^{\phi(n)} \equiv 1 \pmod n
$$

显然费马小定理可以看作是欧拉定理的推广。

## 原根

本节的内容基本作为下一节的背景知识，用于引出离散对数

- 阶的定义
  
  设$m \in \mathbb{Z}, n \in \mathbb{N}, \mathrm{gcd}(m,n) = 1$，则满足$m^e \equiv 1\pmod n$的最小正整数$e$称为$m$关于模$n$的*阶数*，记作$e = \mathrm{ord}_n(m)$

- 阶的性质
  - $\mathrm{gcd}(m,n) = 1 \Rightarrow \mathrm{ord}_n(m)\ |\ \phi(n)$
  - （待完善）

- 原根
  - 定义
     
    设$m \in \mathbb{Z}, n \in \mathbb{N}$，且
    $$
      \mathrm{ord}_n(m) = \phi(n)
    $$

    则称$m$是关于模$n$的一个*原根*。

  - 性质（待完善）
  - 直觉来说，原根可以帮助生成指数剩余和离散对数
  - **求原根的算法的时间复杂度非常高**


- 原根定理
  
  整数$m>1$存在一个原根，当且仅当$m$是$2^ap^b$形式的，其中$p$是一个奇质数，$0 \le a \le 1$，且$b\ge 0$或者$m=4$。此外，若$m$存在一个原根，则$m$存在$\phi(\phi(m))$个原根

## 离散对数与指数剩余

动机：我们希望讨论剩余类的对数行为与求n次根的行为

### 离散对数
- 定义
  
  设$n \in \mathbb{N}$的原根为$m$，$b\in \mathbb{N}$满足$\mathrm{gcd}(b,n) = 1$，则唯一存在整数$e \in \{0, 1, \dots, \phi(n) - 1\}$满足$b\equiv m^e \pmod n$，称指数$e$为以$m$为底的模$n$的关于$b$的**离散对数**，记作

  $$
    e = \mathrm{ind}_m^n(b)
  $$

- 之所以称为离散对数，是因为其定义和代数性质都与对数相似
  - 定义上，我们是在寻找满足方程$m^e \equiv b \pmod n$的最小非负指数$e$
- 离散对数与对数很相似的性质：
  - 拆积为和：$\mathrm{ind}_m^n(cd) \equiv \mathrm{ind}_m^n(c) + \mathrm{ind}_m^n(d) \pmod {\phi(n)}$
  - 提取指数：$\mathrm{ind}_m^n(c^t) \equiv t\ \mathrm{ind}_m^n(c) \pmod {\phi(n)}$
  - $\mathrm{ind}_m^n(1) = 0$
  - $\mathrm{ind}_m^n(m) = 1$
  

### 模形式开根与指数剩余
- 定义
  
  设$m, n \in \mathbb{N}, c \in \mathbb{Z}, \mathrm{gcd}(c,n) = 1$，若对某个$x \in \mathbb{Z}$成立$x^m \equiv c \pmod n$，则称$c$为一个模$n$的*m次指数剩余*，称$x$为模$n$的*m次方根*

- 直观来说，m次剩余类似于m次方，而m次根则类似与开m次方根

- 指数剩余方程可解性的欧拉判定（待完善）

## 二次互反律（待完善）

判定二次剩余方程解的存在性


## 告一段落：密码学怎样运用数学保证安全
- 归根到底是解决*公钥加密算法*的安全性问题
  - 对称加密算法基本上都围绕一组对称的转换，通过破坏明文的统计规律，对抗选择明文攻击来实现保密，*保密性完全依赖于密钥的保密性*，并不涉及什么数学
- 而公钥加密中算法中，公钥总是公开的，它总是蕴藏了加密-解密这一可能过程的线索。密码学运用数学的目的正是**确保计算的正向过程是计算开销小的，逆向过程的计算开销却是巨大的**
  - 大数分解之困难性：代表算法是RSA——RSA猜想，认为破解RSA至少跟大叔分解一样困难
  - 离散对数之困难性：代表算法是ElGamal
  - 目前相当一部分人认为有限域上的椭圆曲线的离散对数比有限乘法域的离散对数更加困难，因此诞生了*椭圆曲线密码学*