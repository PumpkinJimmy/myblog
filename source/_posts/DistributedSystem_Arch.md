---
abbrlink: 2d2c9e23
date: 2021-09-10 15:56:25
title: 分布式系统：体系结构

---
# 分布式系统：体系结构
- 分布式系统的逻辑设计称为*软件体系结构*
- 分布式系统的物理实现称为*系统体系机构*

## 软件体系结构的基本类别
- 分层体系结构
- 基于对象的体系结构
- 以数据为中心的体系结构
- 基于事务的体系结构

### 分层体系结构
- 类似网络协议栈的明确分层
- 服务端/客户端模型

### 基于对象的体系结构
- 类似OOP的建模思维
- 网状，不分层的模型

### 基于事件的体系结构
- 观察者模式
- Publisher/Subscriber型
- 必然存在一个事件总线/消息总线（这就是中间件）
- **时空解耦**
  - 空间上**匿名化**（消息的发布者和接收者互不认知）
  - 时间上**异步化**（消息的发送者和接收者可以不同时在线）

### 数据为中心的体系结构
- 其实就是通过共享数据空间来建立系统
- 同样可以实现时空解耦

## 系统体系结构的基本类别
- 集中式
- 非集中式
- 混合

## 应用分层
- 用户接口层：直接与用户交互的单元，也就是“用户界面”
- 应用处理层：包含主要的**业务逻辑**，但不与具体数据绑定
- 数据层：存储数据

## 基于对象的体系结构
- 利用面向对象的思想进行设计
- 存在封装特性：对象内部的状态（数据）是不可访问的

## RESTful架构

将分布式系统看作资源的集合。应用可以操作资源。

- 资源可以通过命名机制来表示
- 所有服务提供相同的接口
- 使用服务的消息都是自描述的
- 系统不记录服务调用者的状态信息（**无状态**）

RESTful使用HTTP协议的理由：
- 标准化：有利于提供统一接口
- 穿透能力：HTTP请求响应能穿透大部分防火墙

但是HTTP的网络性能较差。

RESTful的缺陷：
- 接口涉及复杂


## 协同
- 时间上是否耦合
- 空间上是否耦合

## 非集中式架构
- 垂直分布
  
  将系统的不同逻辑层次分散到不同机器上（异构）

- 水平分布
  
  系统分布在多个逻辑上等效的节点（同构）。易于拓展。

- 点对点系统
  
  彻底的去中心化，每个节点完全相同的结构，不存在严格的服务端/客户端

  点对点系统又分为：
  - 结构化
  - 非机构化
  - 混合

## 点对点系统(P2P)
### 结构化P2P系统实例：Chord结构
- 本质上是*分布式哈希表*
- 所有的桶都是节点，节点连成环状
- 数据存放在id为哈希值的后继的节点上
- 为加速查找，现有节点需要提供前往其他存在的节点的快速路径
- 若系统添加/删除新节点，需要要完成数据的移动

### 非结构化P2P系统
- 每个节点维护一个动态随机的邻接表；
- 整个网络拓扑结构是一个随机图
- 部分视图构建
  - 主动进程主动推送邻接表中部分表项给对等节点
  - 被动进程返回相同数量的表项

### P2P数据搜索
- 泛洪
- 随机游走
- 超级对等节点与索引节点

## 混合架构
- CDN
- BT

## 中间件
中间件处理的问题：
- 分布式系统的透明性
- 为体系结构充当Adapter
- 自适应

## 自我管理
管理软件：
- Promothous
- Grafana