---
title: LP
date: 2021-07-07 13:02:35
updated: 2021-07-07 13:02:35
tags:
- 专业课
---

## LP(Linear Programming)

### 重要概念
- 标准形式（见下一节）
- 紧约束
- 基本解
- 松弛变量
- 对偶问题

### 线性规划与图论

以下讨论一些图论问题与线性规划问题的相互关联：

- 最短路表达为线性规划问题：

  采用如下手法将求单源最短路径长度的问题表示为一个线性规划：

  首先，令图$G=\langle V, E \rangle$源点为$s$，令$d_{u}$表示顶点$u$到$d_{u}$的最短路径长度，$w(u,v)$表示边$\langle u,v\rangle$的边权.

  由最短路径定义，有：
  $$
    \forall v \in V, d_{v} = \min_{u:\langle u,v \rangle \in E}\{d_u + w(u,v)\}
  $$

  也即：
  $$
    \forall \langle u,v \rangle \in E, d_v \le d_u + w(u,v) 
  $$

  则求到顶点$t$的最短路径等价于以下线性规划问题：
  $$
    \begin{aligned}
      &\max d_t\\
      s.t.\quad &d_v - d_u \le w(u,v), \forall \langle u,v \rangle \in E\\
      &d_s = 0

    \end{aligned}
  $$

- 差分约束系统
  
  最短路问题可以表示为线性规划问题，而某些线性规划问题同样可以表示为最短路问题。

  一个典型的例子就是*差分约束系统*。差分约束系统说的是具有如下形式的线性规划问题：

  $$
    \begin{aligned}
      &\max x_t - x_s\\
      s.t.\quad &x_i - x_j \le a_k\\
      &x_p - x_q \le a_{k+1}\\
      \vdots

    \end{aligned}
  $$

  也即问题的所有约束以及目标函数都可以表示为关于某两个变量之间的差分的线性规划问题。

  这类问题可以不使用单纯性法，而是转化为最短路径使用最短路径算法来求解。

  不妨设所有的不等式约束的都是小于等于，则只要令每个决策变量对应一个图中的顶点，然后对于每一条不等式，连接一条从减数顶点到被减数顶点的有向边，边权为等式右边的常量。然后根据目标函数决定使用哪个点作为源点（有时需要自己构造一个），然后根据最短路取值就可以给出差分约束问题的最优解。

- 为什么最短路对应最大化问题
  
  在差分约束系统中需要注意的是**最大化问题对应最短路**，同理，**最小化问题对应最长路**。这是反直觉的。

  以最短路情形为例子解释：
  - 根据最短路问题性质，由松弛不等式可知，从$d_v$连$d_u$一条边权为$a$的边意味着$d_u \le d_v + a$；
  - 考虑$u$是多条有向边的终点，对应的就是关于$d_u$取值的多个不等式的约束；
  - 最短路取所有这些入边和起点最短路之和的最小，意味着**最短路取值$d_u$是满足所有约束条件的约束变量取值**；
  - 根据入边，关于$u$的多个约束的交集是某个小于等于形式的不等式：$d_u - d_{v_k} \le a_k$，而**最短路是对该上界约束不等式取等号，即$d_u -d_{v_k} = a_k$，因此最短路相当于取了问题可行区域中取了最大**
  - 综上可知，最短路对应差分约束问题的最大化问题。
  
  拓展：
  - 将不等式约束换成大于等于，就构成另一组问题**对应一个差分约束系统最小化问题的最长路径问题**
  - 注意，连边方向不变，只是大于小于号变向了
  - 利用SPFA最短路判负权回路的功能，**可以利用最短路判负权回路来判断一个差分约束系统是否可解**

- 网络流
  
  最大流问题可以表示为线性规划问题

- 二分图匹配
  
  将二分图的所有边转换成统一指向一侧的有向边，然后为另一侧配置一个超级源点，源点连接出侧的所有节点，令所有边容量恰好都是1即可。
  

### 标准形式
$$
\begin{aligned}
  \min \mathbf{c^Tx}\\
  s.t.\quad \mathbf{Ax} = \mathbf{b}\\
  \mathbf{x} \ge 0
\end{aligned}
$$

注：
- 目标函数必须是最小化
- 约束都是等式约束
- 每个变量具有非负约束

如何转换成标准形式：
- 最大化函数变形为最小化函数

### 对偶问题
若线性规划问题有如下形式：
$$
  \max \mathbf{c^Tx}\\
  s.t. \mathbf{Ax} \le \mathbf{b}\\
  \mathbf{x}\ge 0
$$

则其对偶问题为：
$$
  \min \mathbf{b^Ty}\\
  s.t. \mathbf{A^Ty} \ge \mathbf{c}\\
  \mathbf{y} \ge 0
$$

注意在这些问题中$\mathbf{x} \in \mathbb{R}^n,\mathbf{y} \in \mathbb{R}^m,\mathbf{A} \in \mathbb{R}^{m\times n}, \mathbf{b} \in \mathbb{R}^m, \mathbf{c} \in \mathbb{R}^n$

注意变化的符号包括目标函数最大/最小颠倒，不等式变号

可以证明这样一组对偶的线性规划问题的**最优解相同**