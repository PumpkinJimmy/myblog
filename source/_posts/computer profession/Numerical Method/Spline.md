---
title: Spline
tags:
  - 专业课
abbrlink: 325a50df
date: 2021-06-24 20:44:24
updated: 2021-06-24 20:44:24
---
## Spline（样条）

*Polynomial Wiggle（多项式震荡）*现象出现在高次多项式的插值。对于传统拉格朗日插值多项式，$N$个会插值出$N-1$次的多项式。直观来说，高次多项式具有许多个极值点，为了穿过所有的点并保证足够多的极值点，高次的插值多项式当然会反复震荡。

最糟糕的情况，在极高次多项式中，由于舍入误差，计算机绘制的插值曲线甚至不通过插值点

Polynomial Wiggle现象促使人们考虑能否采用光滑的低次多项式分段插值，得到光滑的总体插值曲线？

*Spline（样条）*就是一个“分段函数”，每两个给定数据点之间的闭区间分为一段，每一段都是低阶的插值多项式，且该曲线连续而又光滑，不震荡。最常用的是*Piecewise cubic spline（三次样条）*。实践表明，三次样条表现最好（足够光滑又不会震荡）

### 三次样条
三次样条是样条的一种。**插值函数的每段都是最高不超过三阶的多项式，且整个插值曲线二阶导连续。**

**由于三阶多项式是保证了二阶导连续，故要使整个插值曲线二阶导连续，只需要讨论分段点处的状态。由此导出三次样条的约束：**

Assuming that there is $N+1$ point, then we are going to find $N$ polynoimals $S_k$,
for $x \in [x_k, x_{k+1}]$, $S(x) = S_k(x)$, where $S_k(x)$ is a cubic polynomial, satisfying that:
$$
    S_k(x_k) = y_k\\
    S_k(x_{k+1}) = S_{k+1}(x_{k+1})\\
    S_k'(x_{k+1}) = S_{k+1}'(x_{k+1})\\
    S_k''(x_{k+1}) = S_{k+1}''(x_{k+1})\\
$$

导函数在端点处的值相等保证了$S(x)$是二阶导连续的。

上述表示中，$N+1$个数据点的三次样条一共有$4N$个未知量（$N$个三次多项式的待定系数），但从约束只能导出$4N-2$个方程（$N$个三次多项式，每个多项式对应4个方程，但最后一个多项式只对应2个方程）。因而**对于基本的三次样条问题，需要解欠定方程组**。

经典的解三次样条问题，采用利用先验知识补充约束的方法使得求三次样条问题变为解线性方程组。这种补充约束称为*Endpoint Constraint（端点约束）*，不同的约束策略可以导出不同类型的三次样条。

三种常见的样条类型：
1. Natural（自然）
2. Parabolic Runout（抛物线逃出）
3. Cubic Runout（三次逃出）（最准）

这三种策略影响的主要都是在样条的两个端点处外延的行为。Natural导致在外延的时候近似直线。

### 三次样条核心推导
（待完善）

### 关于样条的其他问题
- **样条只能用于内插值，不能用于回归**。样条非常好地穿过所有的数据点，它会将所有的噪声考虑在内，**但在数据点所在区间外推时，涉及的只有边界点处的低阶多项式，几乎没有捕捉到数据整体的特征。**
- 解基本三次样条问题的线性方程组的时候，其实不一定需要补充条件，可以直接使用伪逆解欠定方程组得到三次样条
- 实际上样条问题的线性方程组之所以是欠定的，是因为，在两个端点的外延区间上，没有足够约束计算出一条唯一的多项式曲线。**换句话说，两个端点的外延区间上的曲线其实是任意指定的**。**所谓的不同类型的样条，“逃出”，本质上是指使用哪种外延的曲线**。三次逃出最准的根本原因是这段曲线来自于边缘的4个点的插值。如果使用更多的点构造“逃出”曲线，其实无非是对更多的点做拉格朗日插值然后做extrapolation罢了，又回到Polynomial Wiggle的老问题，意义不大。
- 观察等间距三次样条方程
  $$
    m_{i-1} + 4m_i + m_{i+1} = \frac{6(y_{i-1} - 2y_i + y_{i+1}}{h^2}
  $$

  其中，方程左侧的是第$i$个分段点的二阶导数，右边的是对应点给定的函数取值。

  计算发现该公式与数值微分的关系：**使用三个点的数值微分公式估算左侧三个二阶导得到的公式恰好是右边的式子**。可能是因为三次样条的每一段都是三次函数，而数值微分公式对这种多项式是准确的。